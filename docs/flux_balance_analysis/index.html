<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Flux balance analysis - Human-GEM Guide</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Flux balance analysis";
        var mkdocs_page_input_path = "flux_balance_analysis.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/matlab.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Human-GEM Guide
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting started</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Flux balance analysis</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#optimization-objective">Optimization objective</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#run-fba">Run FBA</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#an-fba-example">An FBA example</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calculation-of-atp-yield">Calculation of ATP yield</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../gem_extraction/">GEM extraction using ftINIT</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../gem_comparison/">GEM comparison</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../gem_extraction_sc/">GEM extraction from scRNA-Seq data</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../additional_tools/">Additional tools</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../faq_troubleshoot/">FAQs and troubleshooting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../contact/">Contact</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Human-GEM Guide</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Flux balance analysis</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="flux-balance-analysis">Flux Balance Analysis</h1>
<p>One of the most common analysis methods for GEMs is flux balance analysis (FBA). This page will briefly walk through the basics of using FBA with Human-GEM.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You must have a linear optimization solver (e.g., Gurobi) installed and accessible by MATLAB to run FBA. See the <a href="../installation/">installation</a> page of this guide or the <a href="https://github.com/SysBioChalmers/RAVEN/wiki/Installation#dependencies">RAVEN instructions</a> for details on setting up a solver.</p>
</div>
<h2 id="optimization-objective">Optimization objective</h2>
<p>By default, the model objective (defined by the <code>.c</code> model field) is set to maximize flux through the generic human biomass reaction (<code>MAR13082</code>), and all exchange reactions are open.</p>
<pre><code class="language-matlab">ihuman.rxns(ihuman.c == 1)

% ans =
% 
%   1×1 cell array
% 
%     {'MAR13082'}
</code></pre>
<h2 id="run-fba">Run FBA</h2>
<p>Run FBA using the RAVEN <code>solveLP</code> function.</p>
<pre><code class="language-matlab">sol = solveLP(ihuman)

% sol = 
% 
%   struct with fields:
% 
%        x: [13070×1 double]
%        f: -187.3536
%     stat: 1
%      msg: 'Optimal solution found'
</code></pre>
<p>The <code>sol.f</code> field contains the (negative) value of the objective, and the <code>sol.x</code> vector contains the flux value for each reaction.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>As mentioned, all the exchange reactions are fully opened (upper and lower bounds set to 1000 and -1000, respectively). Therefore, the value of the biomass flux here is meaningless (except that it is nonzero), and its units are undefined. Additional constraints, such as those defining the flux bounds of exchange reactions, are necessary to define a feasible solution space.</p>
</div>
<h2 id="an-fba-example">An FBA example</h2>
<h4 id="calculation-of-atp-yield">Calculation of ATP yield</h4>
<p>To illustrate an example of a more meaningful flux solution, we can use FBA to calculate ATP yield (more specifically, the amount of ADP phosphorylated) per glucose consumed. </p>
<p>ATP yield can be quantified by the amount of flux through the ATP hydrolysis reaction <code>MAR03964</code>.</p>
<pre><code class="language-matlab">constructEquations(ihuman, 'MAR03964')

% ans =
% 
%   1×1 cell array
% 
%     {'ATP[c] + H2O[c] =&gt; ADP[c] + H+[c] + Pi[c]'}
</code></pre>
<p>Change the objective to maximize flux through the ATP hydrolysis reaction:</p>
<pre><code class="language-matlab">ihuman = setParam(ihuman, 'obj', 'MAR03964', 1);
</code></pre>
<p>Prevent import of all metabolites except glucose, for which the max import flux is set to 1 (mmol/gDW/h):</p>
<pre><code class="language-matlab">ihuman = setExchangeBounds(ihuman, 'glucose', -1);  % negative flux indicates import
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, the <code>setExchangeBounds</code> function allows unrestricted <em>export</em> of all metabolites. The <em>import</em> of all metabolites is blocked, except for the metabolites specified in the input argument.</p>
</div>
<p>Now perform FBA to determine the maximum amount of ATP hydrolyzed (ADP phosphorylated) per equivalent of glucose consumed.</p>
<pre><code class="language-matlab">sol = solveLP(ihuman)

% sol = 
% 
%   struct with fields:
% 
%        x: [13070×1 double]
%        f: -2
%     stat: 1
%      msg: 'Optimal solution found'
</code></pre>
<p>As expected, the theoretical mol ADP phosphorylated per mol glucose consumed is 2. Note that we have not allowed the import of oxygen, so this is under anaerobic conditions. This is of course purely theoretical given that most humans produce very little of anything when deprived of oxygen.</p>
<p>Let us now calculate the same ATP yield, but in the present of oxygen. We first need to update the exchange constraints:</p>
<pre><code class="language-matlab">ihuman = setExchangeBounds(ihuman, {'glucose', 'O2'}, [-1, -1000]);
</code></pre>
<p>Note that we are allowing effectively infinite oxygen consumption, since we are interested in non-O2-limited ATP yield per glucose. Now re-run the FBA to see how the maximum yield has changed:</p>
<pre><code class="language-matlab">sol = solveLP(ihuman)

% sol = 
% 
%   struct with fields:
% 
%        x: [13070×1 double]
%        f: -31.5000
%     stat: 1
%      msg: 'Optimal solution found'
</code></pre>
<p>We now see a much higher ATP yield per glucose consumed of 31.5.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../getting_started/" class="btn btn-neutral float-left" title="Getting started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../gem_extraction/" class="btn btn-neutral float-right" title="GEM extraction using ftINIT">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../getting_started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../gem_extraction/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
