<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Flux balance analysis - Human-GEM Guide</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Flux balance analysis";
    var mkdocs_page_input_path = "flux_balance_analysis.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/matlab.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Human-GEM Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting started</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Flux balance analysis</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#model-preparation">Model preparation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#run-fba">Run FBA</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#an-fba-example">An FBA example</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calculation-of-atp-yield">Calculation of ATP yield</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../gem_extraction/">GEM extraction using tINIT</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../gem_comparison/">GEM comparison</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Human-GEM Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Flux balance analysis</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="flux-balance-analysis">Flux Balance Analysis</h1>
<p>One of the most common analysis methods for GEMs is flux balance analysis (FBA). This page will briefly walk through the basics of using FBA with Human-GEM.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You must have a linear optimization solver (e.g., Gurobi) installed and accessible by MATLAB to run FBA. See the <a href="../installation/">installation</a> page of this guide or the <a href="https://github.com/SysBioChalmers/RAVEN/wiki/Installation#dependencies">RAVEN instructions</a> for details on setting up a solver.</p>
</div>
<h2 id="model-preparation">Model preparation</h2>
<p>The Human-GEM model is provided in a format containing "boundary" metabolites (in the <code>x</code> compartment). Boundary metabolites are used to balance reactions that exchange mass between the extracellular compartment (<code>s</code>) and the system boundary. For example, take a look at the glucose exchange reaction:</p>
<pre><code class="matlab">constructEquations(ihuman, 'HMR_9034')

% ans =
% 
%   1×1 cell array
% 
%     {'glucose[s] &lt;=&gt; glucose[x]'}
</code></pre>

<p>However, this effectively closes all exchange reactions when running FBA. Therefore, the boundary metabolites need to be removed before using FBA.</p>
<pre><code class="matlab">model = simplifyModel(ihuman);
</code></pre>

<p>Now all boundary metabolites are removed, enabling exchange to/from the system.</p>
<pre><code class="matlab">constructEquations(model, 'HMR_9034')

% ans =
% 
%   1×1 cell array
% 
%     {'glucose[s] &lt;=&gt; '}
</code></pre>

<h2 id="run-fba">Run FBA</h2>
<p>By default, the model objective (defined by the <code>.c</code> model field) is set to maximize flux through the <code>biomass_human</code> reaction, and all exchange reactions are open.</p>
<pre><code class="matlab">model.rxns(model.c == 1)

% ans =
% 
%   1×1 cell array
% 
%     {'biomass_human'}
</code></pre>

<p>Run FBA using the RAVEN <code>solveLP</code> function.</p>
<pre><code class="matlab">sol = solveLP(model)

% sol = 
% 
%   struct with fields:
% 
%        x: [13417×1 double]
%        f: -187.3536
%     stat: 1
%      msg: 'Optimal solution found'
</code></pre>

<p>The <code>sol.f</code> field contains the (negative) value of the objective, and the <code>sol.x</code> vector contains the flux value for each reaction.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>As mentioned, all the exchange reactions are fully opened (upper and lower bounds set to 1000 and -1000, respectively). Therefore, the value of the biomass flux here is meaningless (except that it is nonzero), and its units are undefined. Additional constraints, such as those defining the flux bounds of exchange reactions, are necessary to define a feasible solution space.</p>
</div>
<h2 id="an-fba-example">An FBA example</h2>
<h4 id="calculation-of-atp-yield">Calculation of ATP yield</h4>
<p>To illustrate an example of a more meaningful flux solution, we can use FBA to calculate ATP yield (more specifically, the amount of ADP phosphorylated) per glucose consumed. </p>
<p>ATP yield can be quantified by the amount of flux through the ATP hydrolysis reaction <code>HMR_3964</code>.</p>
<pre><code class="matlab">constructEquations(model, 'HMR_3964')

% ans =
% 
%   1×1 cell array
% 
%     {'ATP[c] + H2O[c] =&gt; ADP[c] + H+[c] + Pi[c]'}
</code></pre>

<p>Change the objective to maximize flux through the ATP hydrolysis reaction:</p>
<pre><code class="matlab">model = setParam(model, 'obj', 'HMR_3964', 1);
</code></pre>

<p>Prevent import of all metabolites except glucose, for which the max import flux is set to 1 (mmol/gDW/h):</p>
<pre><code class="matlab">model = setExchangeBounds(model, 'glucose', -1);  % negative flux indicates import
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>setExchangeBounds</code> function will by default allow unrestricted <em>production</em> of all metabolites, but will prevent <em>consumption</em> of any metabolites not specified in the input argument.</p>
</div>
<p>Now perform FBA to determine the maximum amount of ATP hydrolyzed (ADP phosphorylated) per equivalent of glucose consumed.</p>
<pre><code class="matlab">sol = solveLP(model)

% sol = 
% 
%   struct with fields:
% 
%        x: [13417×1 double]
%        f: -2.0000
%     stat: 1
%      msg: 'Optimal solution found'
</code></pre>

<p>As expected, the theoretical mol ADP phosphorylated per mol glucose consumed is 2. Note that we have not allowed the import of oxygen, so this is under anaerobic conditions. This is of course purely theoretical given that most humans produce very little of anything when deprived of oxygen.</p>
<p>Let us now calculate the same ATP yield, but in the present of oxygen. We first need to update the exchange constraints:</p>
<pre><code class="matlab">model = setExchangeBounds(model, {'glucose', 'O2'}, [-1, -1000]);
</code></pre>

<p>Note that we are allowing effectively infinite oxygen consumption, since we are interested in non-O2-limited ATP yield per glucose. Now re-run the FBA to see how the maximum yield has changed:</p>
<pre><code class="matlab">sol = solveLP(model)

% sol = 
% 
%   struct with fields:
% 
%        x: [13417×1 double]
%        f: -31.5000
%     stat: 1
%      msg: 'Optimal solution found'
</code></pre>

<p>We now see a much higher ATP yield per glucose consumed of 31.5.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../gem_extraction/" class="btn btn-neutral float-right" title="GEM extraction using tINIT">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../getting_started/" class="btn btn-neutral" title="Getting started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../getting_started/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../gem_extraction/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
